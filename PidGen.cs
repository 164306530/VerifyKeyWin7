                //string RightsAccountCertificate = HttpUtility.HtmlEncode(PidGen.GetSLCertify());
                //string ProductKeyCertificate = HttpUtility.HtmlEncode(PidGen.GetSLCertifyProduct(txtKey.Text, aid));
                //if(ProductKeyCertificate.StartsWith("0x"))
                //{
                    //result += "Error Coder:" + ProductKeyCertificate;
                //}
                //else
                //{
                    //result += "Error Coder:" + PidGen.GetErrorCoderWin7(ProductKeyCertificate, RightsAccountCertificate);
                //}


namespace PidKey
{
    class PidGen
    {
        
        public static string GetSLCertify()
        {

            string requestXml = "<soap:Envelope xmlns:soap=\"http://schemas.xmlsoap.org/soap/envelope/\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" xmlns:soapenc=\"http://schemas.xmlsoap.org/soap/encoding/\"><soap:Body><RequestSecurityToken xmlns=\"http://schemas.xmlsoap.org/ws/2004/04/security/trust\"><TokenType>RAC</TokenType><RequestType>http://schemas.xmlsoap.org/ws/2004/04/security/trust/Issue</RequestType><UseKey><Values xmlns:q1=\"http://schemas.xmlsoap.org/ws/2004/04/security/trust\" soapenc:arrayType=\"q1:TokenEntry[1]\"><TokenEntry><Name>SPCPublicCertificate</Name><Value>&lt;r:license licenseId=\"{c291d3e7-efe1-4dad-856f-b7bb5e60467d}\" xmlns:r=\"urn:mpeg:mpeg21:2003:01-REL-R-NS\"&gt;&lt;r:title&gt;XrML 2.1 License - {msft:sl/SPC/ACTIVATED/PUBLIC}&lt;/r:title&gt;&lt;r:grant&gt;&lt;r:keyHolder licensePartId=\"SPCKey\"&gt;&lt;r:info&gt;&lt;KeyValue xmlns=\"http://www.w3.org/2000/09/xmldsig#\"&gt;&lt;RSAKeyValue&gt;&lt;Modulus&gt;455AF+q1hdtOI7Tce9KmyGZKUiQ2Tg8GWFo4JYUqz9Q2fZWxOY63zzOoxkgX5ITF3pTTEydAV/vBGPsIAqDTutsBz+d5qhPbYPGzFTAFsxL+KhGkn7NTGZQoRlfwQgebiGEfALKy4h1uWIbHhqyMjgF6KNGVhNGzA3yE2hsfDCs=&lt;/Modulus&gt;&lt;Exponent&gt;AQAB&lt;/Exponent&gt;&lt;/RSAKeyValue&gt;&lt;/KeyValue&gt;&lt;/r:info&gt;&lt;/r:keyHolder&gt;&lt;r:possessProperty /&gt;&lt;securityProcessor licensePartId=\"SPData\" xmlns=\"http://www.microsoft.com/DRM/XrML2/TM/v2\"&gt;&lt;tm:assurance xmlns:tm=\"http://www.microsoft.com/DRM/XrML2/TM/v2\"&gt;urn:msft:sl/Assurance/SLS-Default/1.0&lt;/tm:assurance&gt;&lt;/securityProcessor&gt;&lt;/r:grant&gt;&lt;r:issuer&gt;&lt;Signature xmlns=\"http://www.w3.org/2000/09/xmldsig#\"&gt;&lt;SignedInfo&gt;&lt;CanonicalizationMethod Algorithm=\"http://www.microsoft.com/xrml/lwc14n\" /&gt;&lt;SignatureMethod Algorithm=\"http://www.w3.org/2000/09/xmldsig#rsa-sha1\" /&gt;&lt;Reference&gt;&lt;Transforms&gt;&lt;Transform Algorithm=\"urn:mpeg:mpeg21:2003:01-REL-R-NS:licenseTransform\" /&gt;&lt;Transform Algorithm=\"http://www.microsoft.com/xrml/lwc14n\" /&gt;&lt;/Transforms&gt;&lt;DigestMethod Algorithm=\"http://www.w3.org/2000/09/xmldsig#sha1\" /&gt;&lt;DigestValue&gt;qievKyf5UwTCAvMlGhjFPltwZ3U=&lt;/DigestValue&gt;&lt;/Reference&gt;&lt;/SignedInfo&gt;&lt;SignatureValue&gt;fI9dh/AdVAlzMDoOJ6NYsNyCHOQrBuQDGX+vC10tTspZi47HQfYHQUzGP062On07PpFFyIoUjLMwoyVMBareoYnqqCqDKBiuqhqGVru2r5zHsjRT8PrPBm+G9WCyHop5TAfrJE2OTFLCL7yxkyjMnnVDqKoXlWS9a4IJViJrwcBURYLXpKeJtZ/Sekds+4dSlDthdeiiGLC01+1ou8PBAUebBQahlavnn9p1Iibg5OLgi2x5ZrcgTg4j8DNYKBZXG6GKbK5J3wdlx9Q5uTglYv6Zk7rTSaAG8qTsevOFBoDJBT07Dkbq9zRidj45t2z7C5mPBGR7Byhj77KLjoQ5+Q==&lt;/SignatureValue&gt;&lt;KeyInfo&gt;&lt;KeyValue&gt;&lt;RSAKeyValue&gt;&lt;Modulus&gt;5peib3RqV+TBpGM5w4CSa1AhjLCMvjvxnQXlG7N5N7SyE3LDVtPr0zOjm0XSEZVU14Lw7c/Y/kVWhpUD6ONv4sDeR95w7eHskZGIOn36jSuV7I8tuDDaRbXDi8Ou0LH8XCqcjESjSD5JICStYuBg4tUdSYlH1pCXdcPGtFdLiKNUWr91svU7fWswEI75qUHMMvXDTousBPnqzkAMae0BVTkhJE1g2ICMNlyKoCdAzXGcx6M9a4oITjqWXgw078um4SEr1OWhzltJU97FG17q8W46ROHaufsmsb0LDLiqJj1VOP411l8MyQkeQQyUTQG6YfvSNe9XZTbW05xOEzLLPw==&lt;/Modulus&gt;&lt;Exponent&gt;AQAB&lt;/Exponent&gt;&lt;/RSAKeyValue&gt;&lt;/KeyValue&gt;&lt;/KeyInfo&gt;&lt;/Signature&gt;&lt;r:details&gt;&lt;r:timeOfIssue&gt;2019-01-09T07:22:19Z&lt;/r:timeOfIssue&gt;&lt;/r:details&gt;&lt;/r:issuer&gt;&lt;r:otherInfo&gt;&lt;tm:infoTables xmlns:tm=\"http://www.microsoft.com/DRM/XrML2/TM/v2\"&gt;&lt;tm:infoList tag=\"#global\"&gt;&lt;tm:infoStr name=\"licenseType\"&gt;msft:sl/SPC/ACTIVATED/PUBLIC&lt;/tm:infoStr&gt;&lt;tm:infoStr name=\"licenseVersion\"&gt;2.0&lt;/tm:infoStr&gt;&lt;tm:infoStr name=\"licensorUrl\"&gt;http://licensing.microsoft.com&lt;/tm:infoStr&gt;&lt;tm:infoStr name=\"licenseCategory\"&gt;msft:sl/SPC/ACTIVATED/PUBLIC&lt;/tm:infoStr&gt;&lt;tm:infoStr name=\"issuanceCertificateId\"&gt;{57d6dc1b-f556-4f5b-935b-3b379fd9dda8}&lt;/tm:infoStr&gt;&lt;tm:infoStr name=\"sysprepAction\"&gt;rearm&lt;/tm:infoStr&gt;&lt;tm:infoStr name=\"spcActivationGroup\"&gt;msft:Windows/6.0/SPC/Retail&lt;/tm:infoStr&gt;&lt;tm:infoStr name=\"privateCertificateId\"&gt;{1fc6170a-8466-4538-89ed-f2c406c3592f}&lt;/tm:infoStr&gt;&lt;/tm:infoList&gt;&lt;/tm:infoTables&gt;&lt;/r:otherInfo&gt;&lt;/r:license&gt;</Value></TokenEntry></Values></UseKey><Claims><Values xmlns:q1=\"http://schemas.xmlsoap.org/ws/2004/04/security/trust\" soapenc:arrayType=\"q1:TokenEntry[8]\"><TokenEntry><Name>BindingType</Name><Value>msft:rm/algorithm/hwid/4.0</Value></TokenEntry><TokenEntry><Name>Binding</Name><Value>NAAAAAEABAABAAEAAQABAAAAAgABAAEA6GFc1g8W2YLf4Oa3DFxiBfwU5yFjqdfx3dxwKA==</Value></TokenEntry><TokenEntry><Name>otherInfoPublic.licenseCategory</Name><Value>msft:sl/RAC/ACTIVATED/PUBLIC</Value></TokenEntry><TokenEntry><Name>otherInfoPrivate.licenseCategory</Name><Value>msft:sl/RAC/ACTIVATED/PRIVATE</Value></TokenEntry><TokenEntry><Name>otherInfoPublic.sysprepAction</Name><Value>rearm</Value></TokenEntry><TokenEntry><Name>otherInfoPrivate.sysprepAction</Name><Value>rearm</Value></TokenEntry><TokenEntry><Name>otherInfoPublic.racActivationGroup</Name><Value>msft:Windows/6.0/RAC/Retail</Value></TokenEntry><TokenEntry><Name>otherInfoPrivate.racActivationGroup</Name><Value>msft:Windows/6.0/RAC/Retail</Value></TokenEntry></Values></Claims></RequestSecurityToken></soap:Body></soap:Envelope>";
            HttpWebRequest request = (HttpWebRequest)WebRequest.Create("https://activation.sls.microsoft.com/slrac/SLCertify.asmx");
            byte[] bytes;
            bytes = System.Text.Encoding.ASCII.GetBytes(requestXml);
            request.Accept = "text/*";
            request.KeepAlive = true;
            request.ContentType = "text/xml; charset=utf-8";
            request.UserAgent = "SLSSoapClient";
            request.Headers.Add("SOAPAction", "http://microsoft.com/SL/CertificationService/IssueToken");
            request.ContentLength = bytes.Length;
            request.Method = "POST";
            Stream requestStream = request.GetRequestStream();
            requestStream.Write(bytes, 0, bytes.Length);
            requestStream.Close();
            HttpWebResponse response = null;
            var result = "";
            try
            {
                response = (HttpWebResponse)request.GetResponse();
                if (response.StatusCode == HttpStatusCode.OK)
                {
                    Stream responseStream = response.GetResponseStream();
                    result = new StreamReader(responseStream).ReadToEnd();
                }
            }
            catch (WebException ex)
            {
                string exMessage = ex.Message;
                if (ex.Response != null)
                {
                    var responseReader = new StreamReader(ex.Response.GetResponseStream());
                    result = responseReader.ReadToEnd();
                }
            }
            using (XmlReader soapReader = XmlReader.Create(new StringReader(result)))
            {
                soapReader.ReadToFollowing("Value");
                string responseXML = soapReader.ReadElementContentAsString();
                return responseXML;
            }
        }
        public static string GetSLCertifyProduct(string ProductKey,string ActivationID)
        {

            string requestXml = "<soap:Envelope xmlns:soap=\"http://schemas.xmlsoap.org/soap/envelope/\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" xmlns:soapenc=\"http://schemas.xmlsoap.org/soap/encoding/\"><soap:Body><RequestSecurityToken xmlns=\"http://schemas.xmlsoap.org/ws/2004/04/security/trust\"><TokenType>PKC</TokenType><RequestType>http://schemas.xmlsoap.org/ws/2004/04/security/trust/Issue</RequestType><UseKey><Values xsi:nil=\"1\"/></UseKey><Claims><Values xmlns:q1=\"http://schemas.xmlsoap.org/ws/2004/04/security/trust\" soapenc:arrayType=\"q1:TokenEntry[3]\"><TokenEntry><Name>ProductKey</Name><Value>"+ ProductKey + "</Value></TokenEntry><TokenEntry><Name>ProductKeyType</Name><Value>msft:rm/algorithm/pkey/2005</Value></TokenEntry><TokenEntry><Name>ProductKeyActConfigId</Name><Value>msft2005:"+ ActivationID+ "&amp;oEROiKcBAAAAAAAA</Value></TokenEntry></Values></Claims></RequestSecurityToken></soap:Body></soap:Envelope>";
            HttpWebRequest request = (HttpWebRequest)WebRequest.Create("https://activation.sls.microsoft.com/slpkc/SLCertifyProduct.asmx");
            byte[] bytes;
            bytes = System.Text.Encoding.ASCII.GetBytes(requestXml);
            request.Accept = "text/*";
            request.KeepAlive = true;
            request.ContentType = "text/xml; charset=utf-8";
            request.UserAgent = "SLSSoapClient";
            request.Headers.Add("SOAPAction", "http://microsoft.com/SL/ProductCertificationService/IssueToken");
            request.ContentLength = bytes.Length;
            request.Method = "POST";
            Stream requestStream = request.GetRequestStream();
            requestStream.Write(bytes, 0, bytes.Length);
            requestStream.Close();
            HttpWebResponse response = null;
            var result = "";
            try
            {
                response = (HttpWebResponse)request.GetResponse();
                if (response.StatusCode == HttpStatusCode.OK)
                {
                    Stream responseStream = response.GetResponseStream();
                    result = new StreamReader(responseStream).ReadToEnd();
                }
            }
            catch (WebException ex)
            {
                string exMessage = ex.Message;
                if (ex.Response != null)
                {
                    var responseReader = new StreamReader(ex.Response.GetResponseStream());
                    result = responseReader.ReadToEnd();
                }
            }
            var retstring = HttpUtility.HtmlDecode(HttpUtility.UrlDecode(result));
                try
                {
                    XmlReader soapReader = XmlReader.Create(new StringReader(result));
                    soapReader.ReadToFollowing("Value");
                    string responseXML = soapReader.ReadElementContentAsString();
                    return responseXML;
                }
                catch
                {
                    XmlReader soapReader = XmlReader.Create(new StringReader(result));
                    soapReader.ReadToFollowing("HRESULT");
                    string responseXML = soapReader.ReadElementContentAsString();
                    return responseXML;
                }

        }
        public static string GetErrorCoderWin7(string ProductKeyCertificate, string RightsAccountCertificate)
        {

            string requestXml = "<soap:Envelope xmlns:soap=\"http://schemas.xmlsoap.org/soap/envelope/\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" xmlns:soapenc=\"http://schemas.xmlsoap.org/soap/encoding/\"><soap:Body><RequestSecurityToken xmlns=\"http://schemas.xmlsoap.org/ws/2004/04/security/trust\"><TokenType>UseLicense</TokenType><RequestType>http://schemas.xmlsoap.org/ws/2004/04/security/trust/Issue</RequestType><UseKey><Values xmlns:q1=\"http://schemas.xmlsoap.org/ws/2004/04/security/trust\" soapenc:arrayType=\"q1:TokenEntry[4]\"><TokenEntry><Name>SecurityProcessorCertificate</Name><Value>&lt;r:license licenseId=\"{c291d3e7-efe1-4dad-856f-b7bb5e60467d}\" xmlns:r=\"urn:mpeg:mpeg21:2003:01-REL-R-NS\"&gt;&lt;r:title&gt;XrML 2.1 License - {msft:sl/SPC/ACTIVATED/PUBLIC}&lt;/r:title&gt;&lt;r:grant&gt;&lt;r:keyHolder licensePartId=\"SPCKey\"&gt;&lt;r:info&gt;&lt;KeyValue xmlns=\"http://www.w3.org/2000/09/xmldsig#\"&gt;&lt;RSAKeyValue&gt;&lt;Modulus&gt;455AF+q1hdtOI7Tce9KmyGZKUiQ2Tg8GWFo4JYUqz9Q2fZWxOY63zzOoxkgX5ITF3pTTEydAV/vBGPsIAqDTutsBz+d5qhPbYPGzFTAFsxL+KhGkn7NTGZQoRlfwQgebiGEfALKy4h1uWIbHhqyMjgF6KNGVhNGzA3yE2hsfDCs=&lt;/Modulus&gt;&lt;Exponent&gt;AQAB&lt;/Exponent&gt;&lt;/RSAKeyValue&gt;&lt;/KeyValue&gt;&lt;/r:info&gt;&lt;/r:keyHolder&gt;&lt;r:possessProperty /&gt;&lt;securityProcessor licensePartId=\"SPData\" xmlns=\"http://www.microsoft.com/DRM/XrML2/TM/v2\"&gt;&lt;tm:assurance xmlns:tm=\"http://www.microsoft.com/DRM/XrML2/TM/v2\"&gt;urn:msft:sl/Assurance/SLS-Default/1.0&lt;/tm:assurance&gt;&lt;/securityProcessor&gt;&lt;/r:grant&gt;&lt;r:issuer&gt;&lt;Signature xmlns=\"http://www.w3.org/2000/09/xmldsig#\"&gt;&lt;SignedInfo&gt;&lt;CanonicalizationMethod Algorithm=\"http://www.microsoft.com/xrml/lwc14n\" /&gt;&lt;SignatureMethod Algorithm=\"http://www.w3.org/2000/09/xmldsig#rsa-sha1\" /&gt;&lt;Reference&gt;&lt;Transforms&gt;&lt;Transform Algorithm=\"urn:mpeg:mpeg21:2003:01-REL-R-NS:licenseTransform\" /&gt;&lt;Transform Algorithm=\"http://www.microsoft.com/xrml/lwc14n\" /&gt;&lt;/Transforms&gt;&lt;DigestMethod Algorithm=\"http://www.w3.org/2000/09/xmldsig#sha1\" /&gt;&lt;DigestValue&gt;qievKyf5UwTCAvMlGhjFPltwZ3U=&lt;/DigestValue&gt;&lt;/Reference&gt;&lt;/SignedInfo&gt;&lt;SignatureValue&gt;fI9dh/AdVAlzMDoOJ6NYsNyCHOQrBuQDGX+vC10tTspZi47HQfYHQUzGP062On07PpFFyIoUjLMwoyVMBareoYnqqCqDKBiuqhqGVru2r5zHsjRT8PrPBm+G9WCyHop5TAfrJE2OTFLCL7yxkyjMnnVDqKoXlWS9a4IJViJrwcBURYLXpKeJtZ/Sekds+4dSlDthdeiiGLC01+1ou8PBAUebBQahlavnn9p1Iibg5OLgi2x5ZrcgTg4j8DNYKBZXG6GKbK5J3wdlx9Q5uTglYv6Zk7rTSaAG8qTsevOFBoDJBT07Dkbq9zRidj45t2z7C5mPBGR7Byhj77KLjoQ5+Q==&lt;/SignatureValue&gt;&lt;KeyInfo&gt;&lt;KeyValue&gt;&lt;RSAKeyValue&gt;&lt;Modulus&gt;5peib3RqV+TBpGM5w4CSa1AhjLCMvjvxnQXlG7N5N7SyE3LDVtPr0zOjm0XSEZVU14Lw7c/Y/kVWhpUD6ONv4sDeR95w7eHskZGIOn36jSuV7I8tuDDaRbXDi8Ou0LH8XCqcjESjSD5JICStYuBg4tUdSYlH1pCXdcPGtFdLiKNUWr91svU7fWswEI75qUHMMvXDTousBPnqzkAMae0BVTkhJE1g2ICMNlyKoCdAzXGcx6M9a4oITjqWXgw078um4SEr1OWhzltJU97FG17q8W46ROHaufsmsb0LDLiqJj1VOP411l8MyQkeQQyUTQG6YfvSNe9XZTbW05xOEzLLPw==&lt;/Modulus&gt;&lt;Exponent&gt;AQAB&lt;/Exponent&gt;&lt;/RSAKeyValue&gt;&lt;/KeyValue&gt;&lt;/KeyInfo&gt;&lt;/Signature&gt;&lt;r:details&gt;&lt;r:timeOfIssue&gt;2019-01-09T07:22:19Z&lt;/r:timeOfIssue&gt;&lt;/r:details&gt;&lt;/r:issuer&gt;&lt;r:otherInfo&gt;&lt;tm:infoTables xmlns:tm=\"http://www.microsoft.com/DRM/XrML2/TM/v2\"&gt;&lt;tm:infoList tag=\"#global\"&gt;&lt;tm:infoStr name=\"licenseType\"&gt;msft:sl/SPC/ACTIVATED/PUBLIC&lt;/tm:infoStr&gt;&lt;tm:infoStr name=\"licenseVersion\"&gt;2.0&lt;/tm:infoStr&gt;&lt;tm:infoStr name=\"licensorUrl\"&gt;http://licensing.microsoft.com&lt;/tm:infoStr&gt;&lt;tm:infoStr name=\"licenseCategory\"&gt;msft:sl/SPC/ACTIVATED/PUBLIC&lt;/tm:infoStr&gt;&lt;tm:infoStr name=\"issuanceCertificateId\"&gt;{57d6dc1b-f556-4f5b-935b-3b379fd9dda8}&lt;/tm:infoStr&gt;&lt;tm:infoStr name=\"sysprepAction\"&gt;rearm&lt;/tm:infoStr&gt;&lt;tm:infoStr name=\"spcActivationGroup\"&gt;msft:Windows/6.0/SPC/Retail&lt;/tm:infoStr&gt;&lt;tm:infoStr name=\"privateCertificateId\"&gt;{1fc6170a-8466-4538-89ed-f2c406c3592f}&lt;/tm:infoStr&gt;&lt;/tm:infoList&gt;&lt;/tm:infoTables&gt;&lt;/r:otherInfo&gt;&lt;/r:license&gt;</Value></TokenEntry><TokenEntry><Name>RightsAccountCertificate</Name><Value>" + RightsAccountCertificate + "</Value></TokenEntry><TokenEntry><Name>ProductKeyCertificate</Name><Value>" + ProductKeyCertificate +"</Value></TokenEntry><TokenEntry><Name>PublishLicense</Name><Value>&lt;?xml version=\"1.0\" encoding=\"utf-8\"?&gt;&lt;rg:licenseGroup xmlns:rg=\"urn:mpeg:mpeg21:2003:01-REL-R-NS\"&gt;&lt;r:license xmlns:r=\"urn:mpeg:mpeg21:2003:01-REL-R-NS\" licenseId=\"{82eb9025-c25f-4dd6-a035-d6994302beb2}\" xmlns:sx=\"urn:mpeg:mpeg21:2003:01-REL-SX-NS\" xmlns:mx=\"urn:mpeg:mpeg21:2003:01-REL-MX-NS\" xmlns:sl=\"http://www.microsoft.com/DRM/XrML2/SL/v2\" xmlns:tm=\"http://www.microsoft.com/DRM/XrML2/TM/v2\"&gt;&lt;r:title&gt;Windows(R) 7 Publishing License (Public)&lt;/r:title&gt;&lt;r:grant&gt;&lt;r:forAll varName=\"account\"&gt;&lt;r:anXmlExpression&gt;/tm:account/tm:identity[@type='urn:msft:tm:identity:hwid' or @type='urn:msft:tm:identity:volume' or @type='urn:msft:tm:identity:oem']&lt;/r:anXmlExpression&gt;&lt;/r:forAll&gt;&lt;r:forAll varName=\"accountKey\"&gt;&lt;r:propertyPossessor&gt;&lt;tm:account varRef=\"account\"/&gt;&lt;r:trustedRootIssuers&gt;&lt;r:keyHolder&gt;&lt;r:info&gt;&lt;KeyValue xmlns=\"http://www.w3.org/2000/09/xmldsig#\"&gt;&lt;RSAKeyValue&gt;&lt;Modulus&gt;vv2iRRX7Y9YUKoixKYCJ7h635v4qOaaWAVQ/mgXEh39995vw1QGW91GmUZSCYC8bYuhCp2FOSTkeG+UBM/2i3uYmGgpQxgSJfSDBR0E3ujggB2n3AUmoJ3NR1GfdhUuAoLovFP2xSgBJGu9gjBok6rzsYqc4RuqNb82kKKnlfkuPZoIKaMd6TxNcoIZyX3ZAt5mI5duHx8pxkUWl1woLBmo6PljbrnNly3s55kCzT7VoMp6IzIP35K7BEh6ezt/uVf9JDthR6YazBFbEvCgx/NcqRYmFRIUOwR/zcWtldbT1LZJlPJjWBwILxpTmOgvLoqkmO8jFqFcJBIeuUSAoEw==&lt;/Modulus&gt;&lt;Exponent&gt;AQAB&lt;/Exponent&gt;&lt;/RSAKeyValue&gt;&lt;/KeyValue&gt;&lt;/r:info&gt;&lt;/r:keyHolder&gt;&lt;/r:trustedRootIssuers&gt;&lt;/r:propertyPossessor&gt;&lt;/r:forAll&gt;&lt;r:forAll varName=\"productId\"&gt;&lt;r:anXmlExpression&gt;/sl:productId/sl:pid&lt;/r:anXmlExpression&gt;&lt;/r:forAll&gt;&lt;r:forAll varName=\"binding\"&gt;&lt;/r:forAll&gt;&lt;r:keyHolder&gt;&lt;r:info&gt;&lt;KeyValue xmlns=\"http://www.w3.org/2000/09/xmldsig#\"&gt;&lt;RSAKeyValue&gt;&lt;Modulus&gt;v0JgOuEWuaA3INoAK10wY7PLaEhyfjfL5A2joNwBR/3ziJxewXKy5QDzZvD3C9eVdvlSqFCDpZEDUxVWvFFeYKI5YkTeK5x7X4nQPodwZAoTJklTUWpfZNslLYJVMaxRvs8htxKoIbvmssqN4Dhy3Oa7HT80GcOvS95M7UCvXcQ7TjrQUV9QNb0w6WLdMVpuktek1CVi4XQ3ELIHZJhyKAtWNGRN4kxZL9nYyDvZ8be5rlGTuhEsgi1oFqnjzMLYXU4wkF/W8mRedIkvoBu3kCjuwEqsr9P5sIbHowqFX5sRxmTrgwoCXPCtFyXCwu9hO75mvb1I1sCuv8W0gTfMtw==&lt;/Modulus&gt;&lt;Exponent&gt;AQAB&lt;/Exponent&gt;&lt;/RSAKeyValue&gt;&lt;/KeyValue&gt;&lt;/r:info&gt;&lt;/r:keyHolder&gt;&lt;r:issue/&gt;&lt;r:grant&gt;&lt;r:forAll varName=\"application\"&gt;&lt;r:anXmlExpression&gt;editionId[@value=\"\" or @value=\"Ultimate\"]&lt;/r:anXmlExpression&gt;&lt;/r:forAll&gt;&lt;r:forAll varName=\"appid\"&gt;&lt;r:propertyPossessor&gt;&lt;tm:application varRef=\"application\"/&gt;&lt;r:trustedRootIssuers&gt;&lt;r:keyHolder&gt;&lt;r:info&gt;&lt;KeyValue xmlns=\"http://www.w3.org/2000/09/xmldsig#\"&gt;&lt;RSAKeyValue&gt;&lt;Modulus&gt;tajcnLtdaeK0abuL2BpVC7obdfSChnHAx7TSn/37DwbTDegkDkEnbr0YyO/Q5Jluj5QD897+nWW54RDbYYTdNgWjyUpwYEJFXSZtd8LFK2mbIjKfG2HIShp6JJARlrgObR89a1EH716nP3PbJk6PWQa6VfjBzPQUgSVywIRU+OKbnzNbUVmQ/rAN6+AN/8fRmFhyKqOAiV/Np2jBtGNxLXm9ebMdm5cB8/YNrjp5Ey0nyAtYvovb0B7wnQZfolMF+OFiqzWJo2Ze0O7WHsWBHtIlGR3+c/IjxUJAsI7O3U4hncCZdvlC5GORI2YL9YHZgU9guSPLhAybQ3IGg7LBuQ==&lt;/Modulus&gt;&lt;Exponent&gt;AQAB&lt;/Exponent&gt;&lt;/RSAKeyValue&gt;&lt;/KeyValue&gt;&lt;/r:info&gt;&lt;/r:keyHolder&gt;&lt;/r:trustedRootIssuers&gt;&lt;/r:propertyPossessor&gt;&lt;/r:forAll&gt;&lt;r:keyHolder varRef=\"accountKey\"/&gt;&lt;sl:runSoftware/&gt;&lt;sl:appId varRef=\"appid\"/&gt;&lt;r:allConditions&gt;&lt;r:allConditions&gt;&lt;sl:productPolicies xmlns:sl=\"http://www.microsoft.com/DRM/XrML2/SL/v2\"&gt;&lt;sl:priority&gt;400&lt;/sl:priority&gt;&lt;sl:policyStr name=\"Security-SPP-Reserved-Family\" attributes=\"override-only\"&gt;Ultimate&lt;/sl:policyStr&gt;&lt;/sl:productPolicies&gt;&lt;sl:proxyExecutionKey xmlns:sl=\"http://www.microsoft.com/DRM/XrML2/SL/v2\"&gt;&lt;/sl:proxyExecutionKey&gt;&lt;/r:allConditions&gt;&lt;mx:renderer&gt;&lt;sl:binding varRef=\"binding\"/&gt;&lt;sl:productId varRef=\"productId\"/&gt;&lt;/mx:renderer&gt;&lt;/r:allConditions&gt;&lt;/r:grant&gt;&lt;r:allConditions&gt;&lt;sl:businessRules xmlns:sl=\"http://www.microsoft.com/DRM/XrML2/SL/v2\"&gt;&lt;/sl:businessRules&gt;&lt;/r:allConditions&gt;&lt;/r:grant&gt;&lt;r:issuer&gt;&lt;Signature xmlns=\"http://www.w3.org/2000/09/xmldsig#\"&gt;&lt;SignedInfo&gt;&lt;CanonicalizationMethod Algorithm=\"http://www.microsoft.com/xrml/lwc14n\"/&gt;&lt;SignatureMethod Algorithm=\"http://www.w3.org/2000/09/xmldsig#rsa-sha1\"/&gt;&lt;Reference&gt;&lt;Transforms&gt;&lt;Transform Algorithm=\"urn:mpeg:mpeg21:2003:01-REL-R-NS:licenseTransform\"/&gt;&lt;Transform Algorithm=\"http://www.microsoft.com/xrml/lwc14n\"/&gt;&lt;/Transforms&gt;&lt;DigestMethod Algorithm=\"http://www.w3.org/2000/09/xmldsig#sha1\"/&gt;&lt;DigestValue&gt;latzLE7Y8EzdqTUgmh2jIWH9U4A=&lt;/DigestValue&gt;&lt;/Reference&gt;&lt;/SignedInfo&gt;&lt;SignatureValue&gt;MH4IBYFoMdkZt/PhmTxE6D5ZD/RLwHdfFk5vLRsreg8Hd7zqy98kussBlAWpQnAVadLG431nXZcMTbyxLHfMvox7EnkW9rJ+WZkzfW5mS7wsvDddxv3C1Bu7NlPWpz5J13mJsfUgRVBTjO3neObMIo4jgy57JDJqXB4V16SmH4yTdzJ8qhk0DuHZNcx9lV/hR4ezf3872A1mkBWpH1P1VrVhOFPyhYv8T2mrbS9nQoArYOnwANHChtBRc89gxEIr+zsMygHI4R4syxrhS0RFMlgaTi6CNLiHwdlS0dSmVr1nzT4QFSECzYTO4TY+Kp5rQK5wJ+y1As4BT3CydY/GYA==&lt;/SignatureValue&gt;&lt;KeyInfo&gt;&lt;KeyValue&gt;&lt;RSAKeyValue&gt;&lt;Modulus&gt;tajcnLtdaeK0abuL2BpVC7obdfSChnHAx7TSn/37DwbTDegkDkEnbr0YyO/Q5Jluj5QD897+nWW54RDbYYTdNgWjyUpwYEJFXSZtd8LFK2mbIjKfG2HIShp6JJARlrgObR89a1EH716nP3PbJk6PWQa6VfjBzPQUgSVywIRU+OKbnzNbUVmQ/rAN6+AN/8fRmFhyKqOAiV/Np2jBtGNxLXm9ebMdm5cB8/YNrjp5Ey0nyAtYvovb0B7wnQZfolMF+OFiqzWJo2Ze0O7WHsWBHtIlGR3+c/IjxUJAsI7O3U4hncCZdvlC5GORI2YL9YHZgU9guSPLhAybQ3IGg7LBuQ==&lt;/Modulus&gt;&lt;Exponent&gt;AQAB&lt;/Exponent&gt;&lt;/RSAKeyValue&gt;&lt;/KeyValue&gt;&lt;/KeyInfo&gt;&lt;/Signature&gt;&lt;r:details&gt;&lt;r:timeOfIssue&gt;2010-11-20T13:36:08Z&lt;/r:timeOfIssue&gt;&lt;/r:details&gt;&lt;/r:issuer&gt;&lt;r:otherInfo xmlns:r=\"urn:mpeg:mpeg21:2003:01-REL-R-NS\"&gt;&lt;tm:infoTables xmlns:tm=\"http://www.microsoft.com/DRM/XrML2/TM/v2\"&gt;&lt;tm:infoList tag=\"#global\"&gt;&lt;tm:infoStr name=\"licenseType\"&gt;msft:sl/PL/GENERIC/PUBLIC&lt;/tm:infoStr&gt;&lt;tm:infoStr name=\"licenseVersion\"&gt;2.0&lt;/tm:infoStr&gt;&lt;tm:infoStr name=\"licensorUrl\"&gt;http://licensing.microsoft.com&lt;/tm:infoStr&gt;&lt;tm:infoStr name=\"licenseCategory\"&gt;msft:sl/PL/GENERIC/PUBLIC&lt;/tm:infoStr&gt;&lt;tm:infoStr name=\"productSkuId\"&gt;{c619d61c-c2f2-40c3-ab3f-c5924314b0f3}&lt;/tm:infoStr&gt;&lt;tm:infoStr name=\"privateCertificateId\"&gt;{75d3bbaa-65e0-4bb0-aa85-61ed95ddee95}&lt;/tm:infoStr&gt;&lt;tm:infoStr name=\"applicationId\"&gt;{55c92734-d682-4d71-983e-d6ec3f16059f}&lt;/tm:infoStr&gt;&lt;tm:infoStr name=\"productName\"&gt;Windows(R) 7&lt;/tm:infoStr&gt;&lt;tm:infoStr name=\"productAuthor\"&gt;Microsoft Corporation&lt;/tm:infoStr&gt;&lt;tm:infoStr name=\"productDescription\"&gt;Windows Operating System - Windows(R) 7&lt;/tm:infoStr&gt;&lt;tm:infoStr name=\"clientIssuanceCertificateId\"&gt;{4961cc30-d690-43be-910c-8e2db01fc5ad}&lt;/tm:infoStr&gt;&lt;tm:infoStr name=\"referralData\"&gt;ReferralId=000000;PartnerId=00000000-0000-0000-0000-000000000000&lt;/tm:infoStr&gt;&lt;/tm:infoList&gt;&lt;/tm:infoTables&gt;&lt;/r:otherInfo&gt;&lt;/r:license&gt;&lt;r:license xmlns:r=\"urn:mpeg:mpeg21:2003:01-REL-R-NS\" licenseId=\"{75d3bbaa-65e0-4bb0-aa85-61ed95ddee95}\" xmlns:sx=\"urn:mpeg:mpeg21:2003:01-REL-SX-NS\" xmlns:mx=\"urn:mpeg:mpeg21:2003:01-REL-MX-NS\" xmlns:sl=\"http://www.microsoft.com/DRM/XrML2/SL/v2\" xmlns:tm=\"http://www.microsoft.com/DRM/XrML2/TM/v2\"&gt;&lt;r:title&gt;Windows(R) 7 Publishing License (Private)&lt;/r:title&gt;&lt;r:grant&gt;&lt;r:encryptedGrant&gt;&lt;EncryptionMethod xmlns=\"http://www.w3.org/2001/04/xmlenc#\" Algorithm=\"http://www.w3.org/2001/04/xmlenc#aes128-cbc\"/&gt;&lt;KeyInfo xmlns=\"http://www.w3.org/2000/09/xmldsig#\"&gt;&lt;EncryptedKey xmlns=\"http://www.w3.org/2001/04/xmlenc#\"&gt;&lt;EncryptionMethod Algorithm=\"http://www.w3.org/2001/04/xmlenc#rsa-oaep-mgf1p\" /&gt;&lt;KeyInfo xmlns=\"http://www.w3.org/2000/09/xmldsig#\"&gt;&lt;KeyValue xmlns=\"http://www.w3.org/2000/09/xmldsig#\"&gt;&lt;RSAKeyValue&gt;&lt;Modulus&gt;v0JgOuEWuaA3INoAK10wY7PLaEhyfjfL5A2joNwBR/3ziJxewXKy5QDzZvD3C9eVdvlSqFCDpZEDUxVWvFFeYKI5YkTeK5x7X4nQPodwZAoTJklTUWpfZNslLYJVMaxRvs8htxKoIbvmssqN4Dhy3Oa7HT80GcOvS95M7UCvXcQ7TjrQUV9QNb0w6WLdMVpuktek1CVi4XQ3ELIHZJhyKAtWNGRN4kxZL9nYyDvZ8be5rlGTuhEsgi1oFqnjzMLYXU4wkF/W8mRedIkvoBu3kCjuwEqsr9P5sIbHowqFX5sRxmTrgwoCXPCtFyXCwu9hO75mvb1I1sCuv8W0gTfMtw==&lt;/Modulus&gt;&lt;Exponent&gt;AQAB&lt;/Exponent&gt;&lt;/RSAKeyValue&gt;&lt;/KeyValue&gt;&lt;/KeyInfo&gt;&lt;CipherData&gt;&lt;CipherValue&gt;W9Umb+v1z+5z2vOMUBaAhZ1LKtk0behRUfIZPS6iTV/PddDBsLWScYNJOrwBiWwiwP3rT4pFsnU1+3sCIkx+iW1xwGohLOLVOFW12Px/5RlZxViNZfI2ADIz8PLNGMIt4j5sw+wM8jDfcLiqAvONVRowz/DJDBDcILr1bX9trIzvBUvKLs2u2wdUrZanLy7iHzY0qQLZMjSH02WKN+kS//VEKCvMo+NmH1f897OSoY3/mfPy39blqBhCcTeOyyzVdvSzp+om3E6lPjknOFGZ41e9YV7zE6rHowGRMXv4Zq4EFJQ3JQGKcmgsa7ZgJPokrdQcVCN9vMoBpG1kEwu5hA==&lt;/CipherValue&gt;&lt;/CipherData&gt;&lt;/EncryptedKey&gt;&lt;/KeyInfo&gt;&lt;CipherData xmlns=\"http://www.w3.org/2001/04/xmlenc#\"&gt;&lt;CipherValue&gt;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&lt;/CipherValue&gt;&lt;/CipherData&gt;&lt;/r:encryptedGrant&gt;&lt;/r:grant&gt;&lt;r:issuer&gt;&lt;Signature xmlns=\"http://www.w3.org/2000/09/xmldsig#\"&gt;&lt;SignedInfo&gt;&lt;CanonicalizationMethod Algorithm=\"http://www.microsoft.com/xrml/lwc14n\"/&gt;&lt;SignatureMethod Algorithm=\"http://www.w3.org/2000/09/xmldsig#rsa-sha1\"/&gt;&lt;Reference&gt;&lt;Transforms&gt;&lt;Transform Algorithm=\"urn:mpeg:mpeg21:2003:01-REL-R-NS:licenseTransform\"/&gt;&lt;Transform Algorithm=\"http://www.microsoft.com/xrml/lwc14n\"/&gt;&lt;/Transforms&gt;&lt;DigestMethod Algorithm=\"http://www.w3.org/2000/09/xmldsig#sha1\"/&gt;&lt;DigestValue&gt;ZtsHovP7OBVt1LI2tHvbgTTqeE0=&lt;/DigestValue&gt;&lt;/Reference&gt;&lt;/SignedInfo&gt;&lt;SignatureValue&gt;Ko1jy16MwvPRJ0qDPUtsX6JBQeGJcO8i579s1oZLAZIpvHIZEOZJybER3SxOuF0piCui1sMzH11/E9J7/UaQqksoMdcDZqiGKbcBTkn4we5K0U/ak4mMI4v2TUQW1yBLHzUYmywNes8e5l/LJeVJMpAClnV2LgSRo+pT6MW0Ghyv/WoxaUBNY4QFHU+Rx4JXeRt+3hSHrF6YrcNR7/75S1exqNfEQZ/h0UGtOx6hexk0M0o5g45zY8wYNqKb8c0S73XwTqVif8HidqkUAjOoNtEep2KYCG0jIvt0OF4JjtzGlSTaTFDiYdZkm6riiMYMA3KtzZm33zjaclDe1TEUTQ==&lt;/SignatureValue&gt;&lt;KeyInfo&gt;&lt;KeyValue&gt;&lt;RSAKeyValue&gt;&lt;Modulus&gt;tajcnLtdaeK0abuL2BpVC7obdfSChnHAx7TSn/37DwbTDegkDkEnbr0YyO/Q5Jluj5QD897+nWW54RDbYYTdNgWjyUpwYEJFXSZtd8LFK2mbIjKfG2HIShp6JJARlrgObR89a1EH716nP3PbJk6PWQa6VfjBzPQUgSVywIRU+OKbnzNbUVmQ/rAN6+AN/8fRmFhyKqOAiV/Np2jBtGNxLXm9ebMdm5cB8/YNrjp5Ey0nyAtYvovb0B7wnQZfolMF+OFiqzWJo2Ze0O7WHsWBHtIlGR3+c/IjxUJAsI7O3U4hncCZdvlC5GORI2YL9YHZgU9guSPLhAybQ3IGg7LBuQ==&lt;/Modulus&gt;&lt;Exponent&gt;AQAB&lt;/Exponent&gt;&lt;/RSAKeyValue&gt;&lt;/KeyValue&gt;&lt;/KeyInfo&gt;&lt;/Signature&gt;&lt;r:details&gt;&lt;r:timeOfIssue&gt;2010-11-20T13:36:08Z&lt;/r:timeOfIssue&gt;&lt;/r:details&gt;&lt;/r:issuer&gt;&lt;r:otherInfo xmlns:r=\"urn:mpeg:mpeg21:2003:01-REL-R-NS\"&gt;&lt;tm:infoTables xmlns:tm=\"http://www.microsoft.com/DRM/XrML2/TM/v2\"&gt;&lt;tm:infoList tag=\"#global\"&gt;&lt;tm:infoStr name=\"licenseType\"&gt;msft:sl/PL/GENERIC/PRIVATE&lt;/tm:infoStr&gt;&lt;tm:infoStr name=\"licenseVersion\"&gt;2.0&lt;/tm:infoStr&gt;&lt;tm:infoStr name=\"licensorUrl\"&gt;http://licensing.microsoft.com&lt;/tm:infoStr&gt;&lt;tm:infoStr name=\"licenseCategory\"&gt;msft:sl/PL/GENERIC/PRIVATE&lt;/tm:infoStr&gt;&lt;tm:infoStr name=\"publicCertificateId\"&gt;{82eb9025-c25f-4dd6-a035-d6994302beb2}&lt;/tm:infoStr&gt;&lt;tm:infoStr name=\"clientIssuanceCertificateId\"&gt;{4961cc30-d690-43be-910c-8e2db01fc5ad}&lt;/tm:infoStr&gt;&lt;/tm:infoList&gt;&lt;/tm:infoTables&gt;&lt;/r:otherInfo&gt;&lt;/r:license&gt;&lt;/rg:licenseGroup&gt;</Value></TokenEntry></Values></UseKey><Claims><Values xmlns:q1=\"http://schemas.xmlsoap.org/ws/2004/04/security/trust\" soapenc:arrayType=\"q1:TokenEntry[9]\"><TokenEntry><Name>otherInfoPublic.licenseCategory</Name><Value>msft:sl/EUL/ACTIVATED/PUBLIC</Value></TokenEntry><TokenEntry><Name>otherInfoPrivate.licenseCategory</Name><Value>msft:sl/EUL/ACTIVATED/PRIVATE</Value></TokenEntry><TokenEntry><Name>otherInfoPublic.sysprepAction</Name><Value>rearm</Value></TokenEntry><TokenEntry><Name>otherInfoPrivate.sysprepAction</Name><Value>rearm</Value></TokenEntry><TokenEntry><Name>ClientInformation</Name><Value>SystemUILanguageId=2052;UserUILanguageId=2052;GeoId=45</Value></TokenEntry><TokenEntry><Name>ReferralInformation</Name><Value>APPID:55c92734-d682-4d71-983e-d6ec3f16059f:ReferralId=000000;</Value></TokenEntry><TokenEntry><Name>ClientSystemTime</Name><Value>2019-06-19T07:43:32Z</Value></TokenEntry><TokenEntry><Name>otherInfoPublic.secureStoreId</Name><Value>7e64023d-bdee-47ea-982a-3ed823c9d7a3</Value></TokenEntry><TokenEntry><Name>otherInfoPrivate.secureStoreId</Name><Value>7e64023d-bdee-47ea-982a-3ed823c9d7a3</Value></TokenEntry></Values></Claims></RequestSecurityToken></soap:Body></soap:Envelope>";
            HttpWebRequest request = (HttpWebRequest)WebRequest.Create("https://activation.sls.microsoft.com/sllicensing/SLLicense.asmx");
            byte[] bytes;
            bytes = System.Text.Encoding.ASCII.GetBytes(requestXml);
            request.Accept = "text/*";
            request.KeepAlive = true;
            request.ContentType = "text/xml; charset=utf-8";
            request.UserAgent = "SLSSoapClient";
            request.Headers.Add("SOAPAction", "http://microsoft.com/SL/LicensingService/IssueToken");
            request.ContentLength = bytes.Length;
            request.Method = "POST";
            Stream requestStream = request.GetRequestStream();
            requestStream.Write(bytes, 0, bytes.Length);
            requestStream.Close();
            HttpWebResponse response = null;
            var result = "";
            try
            {
                response = (HttpWebResponse)request.GetResponse();
                if (response.StatusCode == HttpStatusCode.OK)
                {
                    Stream responseStream = response.GetResponseStream();
                    result = new StreamReader(responseStream).ReadToEnd();
                }
            }
            catch (WebException ex)
            {
                string exMessage = ex.Message;
                if (ex.Response != null)
                {
                    var responseReader = new StreamReader(ex.Response.GetResponseStream());
                    result = responseReader.ReadToEnd();
                }
            }
            using (XmlReader soapReader = XmlReader.Create(new StringReader(result)))
            {
                soapReader.ReadToFollowing("HRESULT");
                string responseXML = soapReader.ReadElementContentAsString();
                return responseXML;
            }
        }

       
    }
}
